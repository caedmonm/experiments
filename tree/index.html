<!DOCTYPE html>
<html>
   <head>
      <meta charset="utf-8">
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
      <title></title>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/0.5.16/p5.js"></script>
      <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=1" />
   </head>
   <body>

   </body>
   <script type="text/javascript">

   function setup() {
      createCanvas(1000, 600);
      // noLoop();
   }

   function leaf(x,y,w,h){
     var scale = Math.random()+.5;
     if(scale>1){
       scale = 1;
     }
     fill("#000000");
     ellipse(x, y, w*scale, h*scale);
   }

   function draw() {
      function drawBranches(startX, startY, trunkWidth, level) {
        if(Math.random()>.7){
          level += Math.round(Math.random()*2);
        }
        if(level < 18) {
          if(level>1){
            var changeX = 300 / (level + 1);
            var changeY = 250 / (level + 1);
          } else {
            var changeX = 50 / (level + 1);
            var changeY = 150 / (level + 1);
          }

          var topRightX = startX + Math.random() * changeX;
          var topRightY = startY - Math.random() * changeY;

          var topLeftX = startX - Math.random() * changeX;
          var topLeftY = startY - Math.random() * changeY;
          // draw right branch
          beginShape();
          strokeWeight(trunkWidth);
          noFill();
          vertex(startX + trunkWidth / 4, startY);
          quadraticVertex(startX + trunkWidth / 4, startY - trunkWidth, topRightX, topRightY);
          endShape();
          if(level<2){
            drawBranches(topRightX, topRightY, trunkWidth * 0.9, level+1);
          } else {
            drawBranches(topRightX, topRightY, trunkWidth * 0.6, level+1);

            // draw left branch
            beginShape();
            strokeWeight(trunkWidth);
            noFill();
            vertex(startX - trunkWidth / 4, startY);
            quadraticVertex(startX - trunkWidth / 4, startY - trunkWidth, topLeftX, topLeftY);
            endShape();
            drawBranches(topLeftX, topLeftY, trunkWidth * 0.7, level+1);
          }
        } else {
          leaf(startX, startY, 2, 4);
        }
      }
      if(frameCount==1){
        drawBranches(500, 600, 15, 0);
      }
   }

   </script>
</html>
